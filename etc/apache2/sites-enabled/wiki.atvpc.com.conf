<VirtualHost *:80>
	# The ServerName directive sets the request scheme, hostname and port that
	# the server uses to identify itself. This is used when creating
	# redirection URLs. In the context of virtual hosts, the ServerName
	# specifies what hostname must appear in the request's Host: header to
	# match this virtual host. For the default virtual host (this file) this
	# value is not decisive as it is used as a last resort host regardless.
	# However, you must set it for any further virtual host explicitly.
	ServerName wiki.atvpc.com

	ServerAdmin admin@atvpc.com
	DocumentRoot /srv/htdocs/wiki.atvpc.com
	
	<Directory /srv/htdocs/wiki.atvpc.com>
		Options +FollowSymLinks
		require all granted
	
		<IfModule mod_rewrite.c>
	                RewriteEngine on
		        RewriteBase /
			RewriteRule ^lib                      - [L]
			RewriteRule ^doku.php                 - [L]
			RewriteRule ^feed.php                 - [L]
			RewriteRule ^install.php              - [L]                
			RewriteRule ^_media/(.*)              lib/exe/fetch.php?media=$1  [QSA,L]
			RewriteRule ^_detail/(.*)             lib/exe/detail.php?media=$1 [QSA,L]
			RewriteRule ^_export/([^/]+)/(.*)     doku.php?do=export_$1&id=$2 [QSA,L]
			RewriteRule ^$                        doku.php  [L]
			RewriteRule (.*)                      doku.php?id=$1  [QSA,L]
		</IfModule>
	</Directory>	

	<Directory /srv/htdocs/wiki.atvpc.com/bin>
	        Require all denied
	</Directory>

	<Directory /srv/htdocs/wiki.atvpc.com/data>
		Require all denied
	</Directory>

RewriteCond %{SERVER_NAME} =wiki.atvpc.com
RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]
</VirtualHost>
